"scr_XMLTemeljniceInventure As screen.'autoLayout_HeaderFooter_ver1.0'":
    Fill: =RGBA(234, 83, 109, 1)
    LoadingSpinnerColor: =App.Theme.Colors.Primary
    OnVisible: |+
        =Set(isLoading, true);
        
        Reset(temeljniceInventureReadyForNavCheckbox);
        
        If(!IsBlank(SelectedFile),
            IfError(
                UpdateContext(
                    {
                        xmlData: (ParseJSON(
                            GetXml.Run(
                                SelectedFile,
                                SelectedFolder
                            ).response).Lines
                        )
                    }
                ), 
                Notify("Greška u obradi.", NotificationType.Error, 2000)
            )
        );
        
        ClearCollect(
            salesCollection,
            IfError(
                ForAll(
                    xmlData.Sales_Line As line,
                    {
                        Document_Type: Text(line.Document_Type),
                        'Sell-to_Customer_No.': Text(line.'Sell-to_Customer_No.'),
                        Document_No: Text(line.Document_No),
                        Line_No: Text(line.Line_No),
                        Type: Text(line.Type),
                        Item_No: Text(line.Item_No),
                        Location_Code: Text(line.Location_Code),
                        Posting_Group: Text(line.Posting_Group),
                        Description: Text(line.Description),
                        Unit_Of_Measure: Text(line.Unit_Of_Measure),
                        Quantity: Text(line.Quantity),
                        Unit_Price: Text(line.Unit_Price),
                        Line_Amount: Text(line.Line_Amount),
                        Line_Discount_Amount: Text(line.Line_Discount_Amount),
                        'Qty-to_Invoice': Text(line.'Qty-to_Invoice'),
                        'Qty-to_Ship': Text(line.'Qty-to_Ship'),
                        Outstand_Quantity: Text(line.Outstand_Quantity)
                    }
                ),
                {
                    Document_Type: Text(xmlData.Transfer_Line.Document_Type),
                    'Sell-to_Customer_No.': Text(xmlData.Transfer_Line.'Sell-to_Customer_No.'),
                    Document_No: Text(xmlData.Transfer_Line.Document_No),
                    Line_No: Text(xmlData.Transfer_Line.Line_No),
                    Type: Text(xmlData.Transfer_Line.Type),
                    Item_No: Text(xmlData.Transfer_Line.Item_No),
                    Location_Code: Text(xmlData.Transfer_Line.Location_Code),
                    Posting_Group: Text(xmlData.Transfer_Line.Posting_Group),
                    Description: Text(xmlData.Transfer_Line.Description),
                    Unit_Of_Measure: Text(xmlData.Transfer_Line.Unit_Of_Measure),
                    Quantity: Text(xmlData.Transfer_Line.Quantity),
                    Unit_Price: Text(xmlData.Transfer_Line.Unit_Price),
                    Line_Amount: Text(xmlData.Transfer_Line.Line_Amount),
                    Line_Discount_Amount: Text(xmlData.Transfer_Line.Line_Discount_Amount),
                    'Qty-to_Invoice': Text(xmlData.Transfer_Line.'Qty-to_Invoice'),
                    'Qty-to_Ship': Text(xmlData.Transfer_Line.'Qty-to_Ship'),
                    Outstand_Quantity: Text(xmlData.Transfer_Line.Outstand_Quantity)
                }
            )
        );
        
        
        Set(isLoading, false);
        
        If(SelectedFolder = ReadyForProcessing, ChangeXmlStatus.Run(SelectedFile, SelectedFolder, InProgress); Set(SelectedFolder, InProgress));
        
        UpdateContext({wizardStep:1});
        

    TemeljniceInventureScreenContainer As groupContainer.verticalAutoLayoutContainer:
        DropShadow: =DropShadow.Light
        Fill: =RGBA(245, 245, 245, 1)
        Height: =Parent.Height
        LayoutAlignItems: =LayoutAlignItems.Stretch
        LayoutDirection: =LayoutDirection.Vertical
        LayoutGap: =16
        LayoutMode: =LayoutMode.Auto
        RadiusBottomLeft: =4
        RadiusBottomRight: =4
        RadiusTopLeft: =4
        RadiusTopRight: =4
        Width: =Parent.Width
        ZIndex: =1

        TemeljniceInventureHeader As Header:
            BasePaletteColor: =RGBA(249, 83, 109, 1)
            DisplayMode: =DisplayMode.Edit
            FontColor: =
            Height: =75
            LayoutMinHeight: =75
            LayoutMinWidth: =Parent.Width
            Logo: =FFLogo
            OnSelectLogo: =Navigate(scr_Entry)
            Style: ='Header.Style'.Primary
            Title: ="TEMELJNICE INVENTURE"
            TitleFontSize: =14
            UserEmail: =User().Email
            UserImage: =User().Image
            UserName: =User().FullName
            Width: =Parent.Width
            X: =0
            Y: =0
            ZIndex: =1

        TemeljniceInventureBody As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            DropShadow: =DropShadow.Light
            Height: =565
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            RadiusBottomLeft: =4
            RadiusBottomRight: =4
            RadiusTopLeft: =4
            RadiusTopRight: =4
            Visible: =!isLoading
            Width: =Parent.Width
            X: =6
            Y: =15
            ZIndex: =2

            Item_Journal_LinesCanvas As fluidGrid.fluidGridWithBlankCard:
                BorderThickness: =0
                Height: =611
                Visible: =wizardStep = 1
                Width: =Parent.Width
                ZIndex: =28

                Item_Journal_Lines As dataCard.blankCard:
                    BorderColor: =RGBA(214, 221, 224, 1)
                    BorderStyle: =BorderStyle.Solid
                    BorderThickness: =0.5
                    DisplayMode: =DisplayMode.Edit
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =729
                    Visible: =wizardStep = 1
                    Width: =Parent.Width
                    X: =0
                    Y: =1
                    ZIndex: =2

                    "Item_Journal_Lines_Gallery As gallery.'BrowseLayout_Vertical_ThreeTextVariant_ver5.0'":
                        BorderColor: =App.Theme.Colors.Darker40
                        Default: =First(Filter(colJournalLine, Barcode = scannedItem))
                        DelayItemLoading: =true
                        Fill: =RGBA(237, 237, 237, 1)
                        Height: =562
                        Items: =colJournalLine
                        Layout: =Layout.Vertical
                        LoadingSpinner: =LoadingSpinner.Data
                        OnSelect: =
                        TemplatePadding: =0
                        TemplateSize: =261
                        Width: =Parent.Width
                        Y: =49
                        ZIndex: =1

                        Separator6_6 As rectangle:
                            BorderColor: =App.Theme.Colors.Darker40
                            Fill: =RGBA(255, 255, 255, 1)
                            Height: =8
                            OnSelect: =Select(Parent)
                            Width: =Parent.TemplateWidth
                            Y: =Parent.TemplateHeight - Self.Height
                            ZIndex: =5

                        Rectangle5_6 As rectangle:
                            BorderColor: =App.Theme.Colors.Darker40
                            Fill: =App.Theme.Colors.Darker30
                            Height: =Parent.TemplateHeight - Separator6_6.Height
                            OnSelect: =Select(Parent)
                            Visible: =ThisItem.IsSelected
                            Width: =4
                            ZIndex: =6

                        Group3 As group:
                            Height: =5
                            Width: =5
                            X: =40
                            Y: =40
                            ZIndex: =19

                            Title5_6 As label:
                                Color: =RGBA(50, 49, 48, 1)
                                DisabledColor: =RGBA(166, 166, 166, 1)
                                Font: =App.Theme.Font
                                FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                                Height: =22
                                OnSelect: =Select(Parent)
                                PaddingBottom: =0
                                PaddingLeft: =20
                                PaddingRight: =20
                                PaddingTop: =0
                                Size: =12
                                Text: |-
                                    ="Br. artikla:   " & ThisItem.'Item_No.'
                                VerticalAlign: =VerticalAlign.Top
                                Width: =Parent.Width
                                Y: =18
                                ZIndex: =1

                            Subtitle4_3 As label:
                                Color: =RGBA(0, 0, 0, 1)
                                DisabledColor: =RGBA(166, 166, 166, 1)
                                Font: =App.Theme.Font
                                FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                                Height: =22
                                OnSelect: =Select(Parent)
                                PaddingBottom: =0
                                PaddingLeft: =20
                                PaddingRight: =20
                                PaddingTop: =0
                                Size: =12
                                Text: |-
                                    ="Naziv artikla:   " & ThisItem.Description
                                VerticalAlign: =VerticalAlign.Top
                                Width: =Parent.Width
                                Y: =55
                                ZIndex: =2

                            Body1_19 As label:
                                Color: =RGBA(0, 0, 0, 1)
                                DisabledColor: =RGBA(166, 166, 166, 1)
                                Font: =App.Theme.Font
                                FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                                Height: =18
                                OnSelect: =Select(Parent)
                                PaddingBottom: =0
                                PaddingLeft: =0
                                PaddingRight: =0
                                PaddingTop: =0
                                Size: =12
                                Text: |-
                                    ="Količina:    "
                                VerticalAlign: =VerticalAlign.Top
                                Width: =88
                                X: =22
                                Y: =93
                                ZIndex: =12

                            Body1_21 As label:
                                Color: =RGBA(0, 0, 0, 1)
                                DisabledColor: =RGBA(166, 166, 166, 1)
                                Font: =App.Theme.Font
                                FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                                Height: =Self.Size * 1.8
                                OnSelect: =Select(Parent)
                                PaddingBottom: =0
                                PaddingLeft: =0
                                PaddingRight: =0
                                PaddingTop: =0
                                Size: =12
                                Text: |-
                                    ="Rok trajanja:    "
                                VerticalAlign: =VerticalAlign.Top
                                Width: =120
                                X: =22
                                Y: =133
                                ZIndex: =13

                            Body1_22 As label:
                                Color: =RGBA(0, 0, 0, 1)
                                DisabledColor: =RGBA(166, 166, 166, 1)
                                Font: =App.Theme.Font
                                FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                                Height: =Self.Size * 1.8
                                OnSelect: =Select(Parent)
                                PaddingBottom: =0
                                PaddingLeft: =0
                                PaddingRight: =0
                                PaddingTop: =0
                                Size: =12
                                Text: |-
                                    ="LOT:    "
                                VerticalAlign: =VerticalAlign.Top
                                Width: =60
                                X: =26
                                Y: =171
                                ZIndex: =14

                            "Item_JournalQty As 'Text input'":
                                Align: ='TextInputCanvas.Align'.Start
                                Appearance: ="FilledDarker"
                                BasePaletteColor: =
                                DelayOutput: =true
                                DisplayMode: =DisplayMode.Edit
                                Fill: =
                                FontColor: =
                                FontSize: =15
                                Height: =31
                                OnChange: |-
                                    =UpdateIf(colJournalLine, Item_Journal_Lines_Gallery.Selected.'Line_No.' = ThisRecord.'Line_No.' ,{Quantity: Value(Item_JournalQty.Value)});
                                Value: =ThisItem.Quantity
                                Width: =113
                                X: =110
                                Y: =86
                                ZIndex: =15

                            DatePickerExpDate_Item_Journal As datepicker:
                                BorderColor: =App.Theme.Colors.Darker40
                                CalendarHeaderFill: =App.Theme.Colors.Primary
                                Color: =RGBA(0, 0, 0, 1)
                                DefaultDate: =If(IsBlank(ThisItem.Item_Expiration_Date), Today(), ThisItem.Item_Expiration_Date)
                                DisabledBorderColor: =RGBA(166, 166, 166, 1)
                                DisabledColor: =RGBA(166, 166, 166, 1)
                                DisabledFill: =RGBA(244, 244, 244, 1)
                                DisplayMode: =If(IsBlank(ThisItem.Item_Expiration_Date), DisplayMode.Disabled, DisplayMode.Edit)
                                Font: =App.Theme.Font
                                Format: ="dd.mm.yyyy"
                                Height: =26
                                HoverDateFill: =App.Theme.Colors.Lighter70
                                IconBackground: =App.Theme.Colors.Primary
                                OnChange: |-
                                    =UpdateIf(colJournalLine, Item_Journal_Lines_Gallery.Selected.'Line_No.' = ThisRecord.'Line_No.' ,{Item_Expiration_Date: Text(DatePickerExpDate_Item_Journal.SelectedDate, "yyyy-mm-dd")})
                                OnSelect: =
                                SelectedDateFill: =App.Theme.Colors.Primary
                                Width: =158
                                X: =146
                                Y: =130
                                ZIndex: =16

                            "Item_Journal_Lot As 'Text input'":
                                Align: ='TextInputCanvas.Align'.Start
                                Appearance: ="FilledDarker"
                                BasePaletteColor: =
                                DelayOutput: =true
                                DisplayMode: =DisplayMode.Edit
                                Fill: =
                                FontColor: =
                                FontSize: =15
                                Height: =31
                                OnChange: |-
                                    =UpdateIf(colJournalLine, Item_Journal_Lines_Gallery.Selected.'Line_No.' = ThisRecord.'Line_No.' ,{Lot_No: Text(Item_Journal_Lot.Value)})
                                Value: =ThisItem.Lot_No
                                Width: =113
                                X: =86
                                Y: =166
                                ZIndex: =17

                            Subtitle4_6 As label:
                                Color: =RGBA(0, 0, 0, 1)
                                DisabledColor: =RGBA(166, 166, 166, 1)
                                Font: =App.Theme.Font
                                FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                                Height: =22
                                OnSelect: =Select(Parent)
                                PaddingBottom: =0
                                PaddingLeft: =20
                                PaddingRight: =20
                                PaddingTop: =0
                                Size: =12
                                Text: |-
                                    ="Barcode:   " & ThisItem.Barcode
                                VerticalAlign: =VerticalAlign.Top
                                Width: =Parent.Width
                                Y: =211
                                ZIndex: =18

                    Container2_6 As groupContainer.horizontalAutoLayoutContainer:
                        DropShadow: =DropShadow.Light
                        Height: =49
                        LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                        LayoutMode: =LayoutMode.Auto
                        PaddingRight: =20
                        RadiusBottomLeft: =4
                        RadiusBottomRight: =4
                        RadiusTopLeft: =4
                        RadiusTopRight: =4
                        Width: =Max(App.Width, App.MinScreenWidth)
                        ZIndex: =5

                        Label2_6 As label:
                            AlignInContainer: =AlignInContainer.Center
                            BorderColor: =App.Theme.Colors.Darker40
                            Color: =RGBA(0, 0, 0, 1)
                            DisabledColor: =RGBA(166, 166, 166, 1)
                            Font: =App.Theme.Font
                            Height: =24
                            PaddingLeft: =20
                            Size: =12
                            Text: ="Stavke temeljnice inventure"
                            Width: |+
                                =250
                                
                            Y: =1
                            ZIndex: =1

                        "BarcodeReader1_3 As 'Barcode Reader'":
                            AlignInContainer: =AlignInContainer.Center
                            BarcodeType: ='BarcodeReader.BarcodeType'.Code128
                            BorderFillColor: =RGBA(0, 0, 0, 1)
                            DisabledBorderColor: =RGBA(166, 166, 166, 1)
                            DisabledContentColor: =RGBA(166, 166, 166, 1)
                            DisabledFillColor: =RGBA(244, 244, 244, 1)
                            DisplayMode: =DisplayMode.Edit
                            FillColor: =RGBA(255, 255, 255, 1)
                            FontSize: =12
                            Height: =28
                            HoverBorderColor: =RGBA(189, 49, 51, 1)
                            HoverContentColor: =RGBA(255, 255, 255, 1)
                            HoverFillColor: =RGBA(189, 49, 51, 1)
                            LayoutMinHeight: =70
                            LayoutMinWidth: =280
                            OnCancel: =false
                            OnScan: |-
                                =UpdateContext({
                                    scannedItem:First(BarcodeReader1_3.Barcodes).Value
                                })
                            PressedBorderColor: =RGBA(189, 49, 51, 1)
                            PressedContentColor: =RGBA(189, 49, 51, 1)
                            PressedFillColor: =RGBA(255, 255, 255, 1)
                            ScanningMode: ='BarcodeReader.ScanningMode'.SelectToScan
                            Text: ="Skener"
                            TextAlignment: =Align.Center
                            TextColor: =RGBA(0, 0, 0, 1)
                            Visible: =If(App.Width > 500, false, true)
                            Width: =80
                            X: =164
                            Y: =9
                            ZIndex: =2

                Item_Journal_Nav As dataCard.blankCard:
                    BorderColor: =RGBA(214, 221, 224, 1)
                    BorderStyle: =BorderStyle.Solid
                    BorderThickness: =0.5
                    DisplayMode: =DisplayMode.Edit
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =14
                    Width: =Parent.Width
                    WidthFit: =false
                    X: =0
                    Y: =0
                    ZIndex: =3

                    Icon1_6 As icon.BackArrow:
                        BorderColor: =App.Theme.Colors.Darker40
                        Color: =App.Theme.Colors.Darker30
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        DisabledColor: =RGBA(244, 244, 244, 1)
                        Height: =25
                        Icon: =Icon.ArrowLeft
                        OnSelect: =Navigate(scr_Entry,ScreenTransition.Fade);
                        Width: =25
                        X: =20
                        ZIndex: =1

        TemeljniceInventureFooter As groupContainer.horizontalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            BorderColor: =RGBA(233, 79, 76, 1)
            DropShadow: =DropShadow.Light
            Fill: =RGBA(237, 237, 237, 1)
            FillPortions: =0
            Height: =50
            LayoutAlignItems: =LayoutAlignItems.End
            LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
            LayoutMinHeight: =50
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            PaddingLeft: =15
            PaddingRight: =20
            RadiusBottomLeft: =4
            RadiusBottomRight: =4
            RadiusTopLeft: =4
            RadiusTopRight: =4
            Visible: =!isLoading
            Width: =Max(App.Width, App.MinScreenWidth)
            ZIndex: =3

            temeljniceInventureReadyForNavCheckbox As Checkbox:
                BasePaletteColor: =RGBA(249, 83, 109, 1)
                CheckboxSize: =16
                DisplayMode: =If(!isLoading, DisplayMode.Edit, DisplayMode.Disabled)
                FontColor: =
                FontSize: =14
                FontWeight: =FontWeight.Bold
                Height: =Parent.Height
                Label: ="Spremno za NAV"
                LayoutMinHeight: =32
                LayoutMinWidth: =160
                OnCheck: =false
                OnUncheck: =false
                Width: =160
                X: =0
                Y: =0
                ZIndex: =2

            saveXml_2 As button:
                AlignInContainer: =AlignInContainer.Center
                BorderColor: =App.Theme.Colors.Primary
                DisabledBorderColor: =RGBA(244, 244, 244, 1)
                DisabledColor: =RGBA(166, 166, 166, 1)
                DisabledFill: =RGBA(244, 244, 244, 1)
                DisplayMode: =If(!isLoading, DisplayMode.Edit, DisplayMode.Disabled)
                Fill: =App.Theme.Colors.Primary
                Font: =App.Theme.Font
                FontWeight: =FontWeight.Semibold
                Height: =30
                HoverBorderColor: =App.Theme.Colors.Darker10
                HoverColor: =RGBA(255, 255, 255, 1)
                HoverFill: =App.Theme.Colors.Darker10
                OnSelect: |-
                    =UpdateContext({
                        journalJsonData:
                        JSON(
                            {
                                Lines: {
                                    Item_Journal_Line: ForAll(colJournalLine,{
                                        Barcode : Text(Barcode),
                                        Description: Text(Description),
                                        Document_Date: Text(Document_Date),
                                        'Document_No.': Text('Document_No.'),
                                        Entry_Type: Text(Entry_Type),
                                        Gen_Bus_Posting_Group: Text(Gen_Bus_Posting_Group),
                                        Item_Expiration_Date: Text(Item_Expiration_Date),
                                        'Item_No.': Text('Item_No.'),
                                        Journal_Batch_Name: Text(Journal_Batch_Name),
                                        Journal_Template_Name: Text(Journal_Template_Name),
                                        'Line_No.': Text('Line_No.'),
                                        Location_Code: Text(Location_Code),
                                        Lot_No: Text(Lot_No),
                                        'Phys._Inventory': Text('Phys._Inventory'),
                                        Posting_Date: Text(Posting_Date),
                                        Qty_Calculated: Text(Qty_Calculated),
                                        Qty_Calculated_Ext: Text(Qty_Calculated_Ext),
                                        Qty_Phys_Inventory: Text(Qty_Phys_Inventory),
                                        Qty_Phys_Inventory_Ext: Text(Qty_Phys_Inventory_Ext),
                                        Quantity: Text(Quantity),
                                        Sales_Price: Text(Sales_Price),
                                        Source_Code: Text(Source_Code),
                                        'Source_No.': Text('Source_No.'),
                                        Source_Type: Text(Source_Type)
                                    })
                                }
                            },JSONFormat.IgnoreUnsupportedTypes
                        )
                    });
                    
                    UpdateContext({response: UpdateXML.Run(journalJsonData, SelectedFile, SelectedFolder, temeljniceInventureReadyForNavCheckbox.Checked)});
                    
                    UpdateContext({parsedResponseMessage : ParseJSON(response.responsemessage)});
                    Set(SelectedFolder, response.folder);
                    
                    If(response.folder = "ReadyForNAVProcessing", Navigate(scr_Entry,ScreenTransition.Fade), Navigate(scr_XMLTemeljniceInventure,ScreenTransition.Fade));
                    
                    Notify(parsedResponseMessage.Message , If(parsedResponseMessage.Status = "200", NotificationType.Success, NotificationType.Error), 2000);
                PressedBorderColor: =App.Theme.Colors.Darker40
                PressedColor: =Self.Color
                PressedFill: =App.Theme.Colors.Darker40
                Size: =12
                Text: ="Sačuvaj"
                Width: =100
                X: =570
                Y: =718
                ZIndex: =3

        Spinner2_4 As Spinner:
            BasePaletteColor: =RGBA(249, 83, 109, 1)
            DisplayMode: =DisplayMode.Edit
            FillPortions: =1
            FontColor: =
            Height: =200
            LayoutMinHeight: =200
            LayoutMinWidth: =200
            SpinnerSize: ='Spinner.SpinnerSize'.Huge
            Visible: =isLoading
            Width: =200
            X: =0
            Y: =0
            ZIndex: =4

