com_Modal As CanvasComponent:
    ChildTabPriority: =
    Fill: =RGBA(0, 0, 0, 0)
    Height: =App.Height
    IsInventura: =false
    IsNabavniNalog: =false
    LineId: ="Text"
    LotNo: =Blank()
    Quantity: =
    QuantityCompleted: =
    QuantityNewLOT: =
    ResEntryId: ="Text"
    Width: =App.Width
    X: =0
    Y: =0
    ZIndex: =1

    con_ModalFade As groupContainer.manualLayoutContainer:
        Fill: =RGBA(0, 0, 0, 0.5)
        Height: =Parent.Height
        Width: =Parent.Width
        ZIndex: =1

        con_Modal As groupContainer.manualLayoutContainer:
            DropShadow: =DropShadow.ExtraBold
            Fill: =RGBA(255, 255, 255, 1)
            Height: =If(isMobile, Parent.Height * 80%, Parent.Height * 50%)
            RadiusBottomLeft: =4
            RadiusBottomRight: =4
            RadiusTopLeft: =4
            RadiusTopRight: =4
            Width: =If(isMobile, Parent.Width * 80%, Parent.Width * 25%)
            X: =(Parent.Width - Self.Width) / 2
            Y: =(Parent.Height - Self.Height) / 2
            ZIndex: =1

            vrt_Modal As groupContainer.verticalAutoLayoutContainer:
                Height: =Parent.Height
                LayoutAlignItems: =LayoutAlignItems.Stretch
                LayoutDirection: =LayoutDirection.Vertical
                LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                LayoutMode: =LayoutMode.Auto
                RadiusBottomLeft: =4
                RadiusBottomRight: =4
                RadiusTopLeft: =4
                RadiusTopRight: =4
                Width: =Parent.Width
                ZIndex: =1

                hrz_ModalHeader As groupContainer.horizontalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    DropShadow: =DropShadow.Light
                    Fill: |
                        =RGBA(189, 49, 51, 1)
                    FillPortions: =0
                    Height: =50
                    LayoutAlignItems: =LayoutAlignItems.Center
                    LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    PaddingLeft: =5
                    PaddingRight: =5
                    ZIndex: =1

                    txt_ModalHeader As Text:
                        Align: ='TextCanvas.Align'.Center
                        AutoHeight: =true
                        BorderStyle: =""
                        DisplayMode: =DisplayMode.Edit
                        FillPortions: =1
                        FontColor: =RGBA(255, 255, 255, 1)
                        Height: =32
                        LayoutMinHeight: =32
                        LayoutMinWidth: =96
                        Size: =20
                        Text: ="Unesite podatke"
                        Width: =96
                        X: =0
                        Y: =0
                        ZIndex: =1

                    btn_ModalClose As Button:
                        Appearance: ='ButtonCanvas.Appearance'.Transparent
                        BasePaletteColor: =
                        BorderStyle: =""
                        DisplayMode: =DisplayMode.Edit
                        FontColor: =RGBA(255, 255, 255, 1)
                        FontSize: =32
                        Height: =32
                        Icon: ="DismissCircle"
                        IconStyle: ='ButtonCanvas.IconStyle'.Filled
                        Layout: ='ButtonCanvas.Layout'.IconOnly
                        LayoutMinHeight: =32
                        LayoutMinWidth: =96
                        OnSelect: |
                            =Reset(inp_rezQty_2);
                            Reset(inp_potrebnoQty_2);
                            Reset(inp_LotNo);
                            Set(
                                isModalOpen,
                                false
                            );
                        Text: ="Zatvori"
                        Width: =32
                        X: =40
                        Y: =40
                        ZIndex: =2

                vrt_ModalBody As groupContainer.verticalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    DropShadow: =DropShadow.Light
                    FillPortions: =3
                    LayoutAlignItems: =LayoutAlignItems.Stretch
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    PaddingBottom: =10
                    ZIndex: =2

                    Container13_12 As groupContainer.verticalAutoLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        LayoutAlignItems: =LayoutAlignItems.Center
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutJustifyContent: =LayoutJustifyContent.Center
                        LayoutMinHeight: =30
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        RadiusBottomLeft: =4
                        RadiusBottomRight: =4
                        RadiusTopLeft: =4
                        RadiusTopRight: =4
                        Visible: =If( IsBlank(com_Modal.LotNo) && (com_Modal.IsInventura) || com_Modal.IsNabavniNalog, true, false)
                        ZIndex: =1

                        TextCanvas3_12 As Text:
                            AutoHeight: =true
                            BorderStyle: =""
                            DisplayMode: =DisplayMode.Edit
                            FontColor: =
                            Height: =32
                            LayoutMinHeight: =32
                            LayoutMinWidth: =80
                            Size: =20
                            Text: ="LOT"
                            Width: =200
                            X: =40
                            Y: =40
                            ZIndex: =1

                        "inp_LotNo As 'Text input'":
                            Align: ='TextInputCanvas.Align'.Center
                            Appearance: ='TextInputCanvas.Appearance'.Outline
                            BasePaletteColor: =
                            BorderStyle: =""
                            DisplayMode: =DisplayMode.Edit
                            FontSize: =0
                            Height: =32
                            LayoutMinHeight: =32
                            LayoutMinWidth: =320
                            OnChange: |
                                =/*If(
                                    (!IsNumeric(inp_rezQty_2.Value) && !IsBlank(inp_rezQty_2.Value)) || Value(inp_rezQty_2.Value) < 0,
                                    Notify(
                                        "Unesite pozitivan broj.",
                                        NotificationType.Error,
                                        2000
                                    );
                                    Reset(inp_rezQty_2);
                                    UpdateContext({potrebnaKolicina: 0}),
                                    If(
                                        Value(inp_rezQty_2.Value) > Abs(glr_ProResEntries.Selected.Quantity_Completed),
                                        Reset(inp_rezQty_2);
                                        UpdateContext({potrebnaKolicina: 0});
                                        Notify(
                                            "Maksimalna količina za isporuku je " & Abs(glr_ProResEntries.Selected.Quantity_Completed),
                                            NotificationType.Information,
                                            2000
                                        ),
                                        UpdateContext({potrebnaKolicina: Abs(glr_ProResEntries.Selected.Quantity) - inp_rezQty_2.Value})
                                    )
                                );*/
                            Placeholder: ="Unesite LOT"
                            Required: =true
                            TriggerOutput: ="FocusOut"
                            Type: ="Text"
                            Value: =com_Modal.LotNo
                            Visible: =true
                            Width: =200
                            X: =40
                            Y: =40
                            ZIndex: =3

                    Container13_10 As groupContainer.verticalAutoLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        LayoutAlignItems: =LayoutAlignItems.Center
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutJustifyContent: =LayoutJustifyContent.Center
                        LayoutMinHeight: =30
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        RadiusBottomLeft: =4
                        RadiusBottomRight: =4
                        RadiusTopLeft: =4
                        RadiusTopRight: =4
                        ZIndex: =3

                        TextCanvas3_11 As Text:
                            AutoHeight: =true
                            BorderStyle: =""
                            DisplayMode: =DisplayMode.Edit
                            Height: =32
                            LayoutMinHeight: =32
                            LayoutMinWidth: =80
                            Size: =20
                            Text: =If(com_Modal.IsInventura,"Količina","Rezervisano")
                            Width: =200
                            X: =40
                            Y: =40
                            ZIndex: =1

                        "inp_rezQty_2 As 'Text input'":
                            Align: ='TextInputCanvas.Align'.Center
                            Appearance: ='TextInputCanvas.Appearance'.Outline
                            BasePaletteColor: =
                            BorderStyle: =""
                            DisplayMode: =DisplayMode.Edit
                            FontSize: =0
                            Height: =32
                            LayoutMinHeight: =32
                            LayoutMinWidth: =320
                            OnChange: =If(inp_rezQty_2.ValidationState = inp_rezQty_2.ValidationState.Error, ErrorMsg.Text = "nesto");
                            Placeholder: ="Unesite rezervisano količinu"
                            Required: =true
                            TriggerOutput: ="FocusOut"
                            Type: ="Text"
                            ValidationState: =If(!IsNumeric(inp_rezQty_2.Value) || Value(inp_rezQty_2.Value) < 0, "Error", "None")
                            Value: |-
                                =If(
                                    com_Modal.IsInventura,
                                    If(
                                        IsBlank(com_Modal.Qty_Phys_Inventory),
                                        1,
                                        Abs(com_Modal.Qty_Phys_Inventory)
                                    ),
                                    If(
                                        IsBlank(com_Modal.QuantityCompleted),
                                        2,
                                        Abs(com_Modal.QuantityCompleted)
                                    )
                                )
                            Visible: =true
                            Width: =200
                            X: =40
                            Y: =40
                            ZIndex: =2

                        TextCanvas1 As Text:
                            AlignInContainer: =AlignInContainer.Center
                            AutoHeight: =false
                            BorderStyle: =""
                            DisplayMode: =DisplayMode.Edit
                            FontColor: =RGBA(215, 58, 60, 1)
                            Height: =20
                            LayoutMinHeight: =32
                            LayoutMinWidth: =96
                            PaddingBottom: =0
                            PaddingLeft: =0
                            PaddingRight: =0
                            PaddingTop: =0
                            Size: =14
                            Text: =If(inp_rezQty_2.ValidationState = inp_rezQty_2.ValidationState.Error, "Unesite pozitivan broj", "")
                            Visible: =true
                            Width: =200
                            X: =0
                            Y: =0
                            ZIndex: =3

                    Container13_11 As groupContainer.verticalAutoLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        LayoutAlignItems: =LayoutAlignItems.Center
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutMinHeight: =30
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        RadiusBottomLeft: =4
                        RadiusBottomRight: =4
                        RadiusTopLeft: =4
                        RadiusTopRight: =4
                        Visible: =!com_Modal.IsInventura && !com_Modal.IsNabavniNalog
                        ZIndex: =4

                        TextCanvas3_13 As Text:
                            AutoHeight: =true
                            BorderStyle: =""
                            DisplayMode: =DisplayMode.Edit
                            Height: =32
                            LayoutMinHeight: =32
                            LayoutMinWidth: =96
                            Size: =20
                            Text: ="Potrebno"
                            Width: =200
                            X: =40
                            Y: =40
                            ZIndex: =1

                        "inp_potrebnoQty_2 As 'Text input'":
                            Align: ='TextInputCanvas.Align'.Center
                            Appearance: ='TextInputCanvas.Appearance'.Outline
                            BasePaletteColor: =
                            BorderStyle: =""
                            DisplayMode: =DisplayMode.Edit
                            FontSize: =0
                            Height: =32
                            LayoutMinHeight: =32
                            LayoutMinWidth: =320
                            OnChange: =false
                            Placeholder: ="Unesite potrebnu količinu"
                            TriggerOutput: ="FocusOut"
                            ValidationState: =If(!IsNumeric(inp_potrebnoQty_2.Value) || Value(inp_potrebnoQty_2.Value) < 0, "Error", "None")
                            Value: =If(IsBlank(com_Modal.QuantityNewLOT),0,Abs(com_Modal.QuantityNewLOT))
                            Width: =200
                            X: =40
                            Y: =40
                            ZIndex: =2

                        TextCanvas1_10 As Text:
                            AlignInContainer: =AlignInContainer.Center
                            AutoHeight: =false
                            BorderStyle: =""
                            DisplayMode: =DisplayMode.Edit
                            FontColor: =RGBA(215, 58, 60, 1)
                            Height: =20
                            LayoutMinHeight: =32
                            LayoutMinWidth: =96
                            PaddingBottom: =0
                            PaddingLeft: =0
                            PaddingRight: =0
                            PaddingTop: =0
                            Size: =14
                            Text: =If(inp_potrebnoQty_2.ValidationState = inp_potrebnoQty_2.ValidationState.Error, "Unesite pozitivan broj", "")
                            Visible: =true
                            Width: =200
                            X: =0
                            Y: =0
                            ZIndex: =3

                    ErrorMsg As Text:
                        AlignInContainer: =AlignInContainer.Stretch
                        AutoHeight: =false
                        BorderColor: =
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =
                        DisplayMode: =DisplayMode.Edit
                        FontColor: =RGBA(215, 58, 60, 1)
                        Height: =35
                        LayoutMinHeight: =32
                        LayoutMinWidth: =96
                        PaddingBottom: =0
                        PaddingLeft: =5
                        PaddingRight: =5
                        PaddingTop: =0
                        Size: =11
                        Text: |-
                            =If(
                                (inp_rezQty_2.Value + inp_potrebnoQty_2.Value) > com_Modal.Quantity,
                                "'Rezervisano' i 'Potrebno' su veći od količine za otpremu (" & com_Modal.Quantity & ") !",
                                ""
                            )
                        VerticalAlign: ='TextCanvas.VerticalAlign'.Middle
                        Visible: =!com_Modal.IsInventura
                        Width: =Parent.Width
                        X: =0
                        Y: =0
                        ZIndex: =5

                hrz_ModalFooter As groupContainer.horizontalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    DropShadow: =DropShadow.Light
                    FillPortions: =0
                    Height: =50
                    LayoutAlignItems: =LayoutAlignItems.Center
                    LayoutGap: =10
                    LayoutJustifyContent: =LayoutJustifyContent.End
                    LayoutMinHeight: =40
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    PaddingLeft: =10
                    PaddingRight: =10
                    ZIndex: =3

                    btn_ModalSave As Button:
                        Align: =Align.Justify
                        BasePaletteColor: =
                        BorderStyle: =""
                        DisplayMode: |-
                            =If(
                                inp_rezQty_2.ValidationState = "Error" || inp_potrebnoQty_2.ValidationState = "Error" || ((inp_rezQty_2.Value + inp_potrebnoQty_2.Value) > com_Modal.Quantity && !com_Modal.IsInventura),
                                DisplayMode.Disabled,
                                DisplayMode.Edit
                            )
                        Height: =32
                        Icon: ="Save"
                        Layout: ='ButtonCanvas.Layout'.IconAfter
                        LayoutMinHeight: =32
                        LayoutMinWidth: =96
                        OnSelect: |
                            =If(
                                com_Modal.IsInventura,
                                Patch(
                                    colLines,
                                    LookUp(
                                        colLines,
                                        'Line_No.' = com_Modal.LineId
                                    ),
                                    {Lot_No: Text(inp_LotNo.Value),Qty_Phys_Inventory: Value(inp_rezQty_2.Value)}
                                ),
                                If(com_Modal.IsNabavniNalog,
                                Patch(
                                    colEntries,
                                    LookUp(
                                        colEntries,
                                        Entry_No = com_Modal.ResEntryId && Source_Ref_No = com_Modal.LineId
                                    ),
                                    {
                                        Quantity_Completed: Value(-inp_rezQty_2.Value),
                                        LOT_No: Text(inp_LotNo.Value)
                                    }
                                ),
                                Patch(
                                    colEntries,
                                    LookUp(
                                        colEntries,
                                        Entry_No = com_Modal.ResEntryId && Source_Ref_No = com_Modal.LineId
                                    ),
                                    {
                                        Quantity_Completed: Value(-inp_rezQty_2.Value),
                                        Quantity_NewLOT: Value(-inp_potrebnoQty_2.Value)
                                    }
                                ))
                            );
                            Reset(inp_rezQty_2);
                            Reset(inp_potrebnoQty_2);
                            Reset(inp_LotNo);
                            Set(
                                isModalOpen,
                                false
                            );
                        Text: ="Spasi"
                        Width: =96
                        X: =0
                        Y: =0
                        ZIndex: =1

